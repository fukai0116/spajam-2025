# WebSocket接続問題の解決策

## 実施した修正

### 1. サーバーのバインドアドレス変更
- `localhost` から `0.0.0.0` に変更
- 全ネットワークインターフェースでリッスン

### 2. FlutterアプリのサーバーURL変更
- `http://localhost:3000` から `http://192.168.0.9:3000` に変更
- ローカルネットワークIPアドレスを使用

### 3. Socket.IO設定の改善
- `transports: ['websocket', 'polling']` - pollingをフォールバックとして追加
- `timeout: 20000` - タイムアウトを20秒に設定
- `forceNew: true` - 新しい接続を強制

## 確認事項

### サーバー状況
- ✅ サーバーが `0.0.0.0:3000` でリッスン中
- ✅ WebSocketサーバー有効
- ✅ プレイヤー接続確認済み

### ネットワーク設定
- ✅ IPv4アドレス: `192.168.0.9`
- ✅ ポート3000が開放済み
- ✅ HTTP接続テスト成功

### Flutterアプリ
- ✅ アプリ起動成功
- ✅ socket_io_clientパッケージ統合済み
- ✅ 接続先URLを更新

## 次のテスト手順

1. **Flutterアプリでテスト**
   - WebSocketテストページにアクセス
   - 接続ボタンをタップ
   - ログでエラーメッセージを確認

2. **ブラウザでテスト**
   - http://192.168.0.9:3000/test/websocket_test.html
   - 自動テスト実行ボタンをクリック

3. **サーバーログ監視**
   - 接続試行の確認
   - エラーメッセージの確認

## トラブルシューティング

### エラー 1225が続く場合
1. Windowsファイアウォール設定確認
2. アンチウイルスソフトのブロック確認
3. Flutterアプリの再起動

### 代替案
1. `127.0.0.1:3000` を試用
2. 別のポート（3001など）を使用
3. HTTPでテストしてからWebSocketに移行

## 現在のステータス

- 🔄 **進行中**: 接続問題の解決
- ✅ **完了**: サーバー設定修正
- ✅ **完了**: Flutterアプリ設定修正
- ⏳ **次**: 実際の接続テスト実行